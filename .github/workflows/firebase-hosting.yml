name: Deploy Next.js Static Export to Firebase Hosting

on:
push:
branches:
- main

jobs:
build_and_deploy:
runs-on: ubuntu-latest
steps:
- name: â¬‡ï¸ Checkout Repository
uses: actions/checkout@v4

  - name: ğŸ› ï¸ Set up Node.js
    uses: actions/setup-node@v4
    with:
      node-version: '20'
      cache: 'npm'

  - name: ğŸ“¦ Install Dependencies
    run: npm ci

  - name: ğŸ—ï¸ Build and Export Static Site
    run: |
      # 1. Build the Next.js project
      npm run build
      # 2. Run the static export step
      npm run export

  - name: ğŸš€ Deploy to Firebase
    uses: FirebaseExtended/action-hosting-deploy@v0
    with:
      repoToken: '${{ secrets.GITHUB_TOKEN }}'
      firebaseServiceAccount: '${{ secrets.FIREBASE_SERVICE_ACCOUNT_PROJECT_ID }}'
      channelId: live
      projectId: 'next-js-site-ac1f6'
      # The public directory for Next.js static export is 'out'
      public: out
